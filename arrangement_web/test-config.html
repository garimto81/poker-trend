<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase í™˜ê²½ë³€ìˆ˜ í…ŒìŠ¤íŠ¸</title>
    
    <!-- Firebase í™˜ê²½ë³€ìˆ˜ ì„¤ì • -->
    <script>
        window.FIREBASE_API_KEY = "AIzaSyD6LVOtT0x30CQNZDt5aSUEBKT8vXPhM6k";
        window.FIREBASE_AUTH_DOMAIN = "ggp-camera.firebaseapp.com";
        window.FIREBASE_PROJECT_ID = "ggp-camera";
        window.FIREBASE_STORAGE_BUCKET = "ggp-camera.appspot.com";
        window.FIREBASE_MESSAGING_SENDER_ID = "906682771595";
        window.FIREBASE_APP_ID = "1:906682771595:web:431b539435f4a0ca294c8e";
        window.FIREBASE_MEASUREMENT_ID = "G-JLR9TMLSS1";
    </script>
    
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .result { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ”¥ Firebase í™˜ê²½ë³€ìˆ˜ ì„¤ì • í…ŒìŠ¤íŠ¸</h1>
    
    <div class="result" id="env-test">
        <h3>1. í™˜ê²½ë³€ìˆ˜ ì„¤ì • í™•ì¸</h3>
        <div id="env-result">í…ŒìŠ¤íŠ¸ ì¤‘...</div>
    </div>
    
    <div class="result" id="config-test">
        <h3>2. Config.js ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸</h3>
        <div id="config-result">í…ŒìŠ¤íŠ¸ ì¤‘...</div>
    </div>
    
    <div class="result" id="firebase-test">
        <h3>3. Firebase ì„¤ì • ìœ íš¨ì„± í…ŒìŠ¤íŠ¸</h3>
        <div id="firebase-result">í…ŒìŠ¤íŠ¸ ì¤‘...</div>
    </div>
    
    <button onclick="runAllTests()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 20px 0;">
        ğŸ§ª ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    </button>
    
    <script type="module">
        // 1. í™˜ê²½ë³€ìˆ˜ ì„¤ì • í™•ì¸
        function testEnvironmentVariables() {
            const envResult = document.getElementById('env-result');
            
            const requiredVars = [
                'FIREBASE_API_KEY',
                'FIREBASE_AUTH_DOMAIN', 
                'FIREBASE_PROJECT_ID',
                'FIREBASE_STORAGE_BUCKET',
                'FIREBASE_MESSAGING_SENDER_ID',
                'FIREBASE_APP_ID',
                'FIREBASE_MEASUREMENT_ID'
            ];
            
            let allPresent = true;
            let results = [];
            
            requiredVars.forEach(varName => {
                const value = window[varName];
                if (value) {
                    results.push(`âœ… ${varName}: ${value.substring(0, 20)}...`);
                } else {
                    results.push(`âŒ ${varName}: ì„¤ì •ë˜ì§€ ì•ŠìŒ`);
                    allPresent = false;
                }
            });
            
            const resultDiv = document.getElementById('env-test');
            if (allPresent) {
                resultDiv.className = 'result success';
                envResult.innerHTML = `<p><strong>âœ… ëª¨ë“  í™˜ê²½ë³€ìˆ˜ê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!</strong></p><pre>${results.join('\n')}</pre>`;
            } else {
                resultDiv.className = 'result error';
                envResult.innerHTML = `<p><strong>âŒ ì¼ë¶€ í™˜ê²½ë³€ìˆ˜ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.</strong></p><pre>${results.join('\n')}</pre>`;
            }
        }
        
        // 2. Config.js ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸
        async function testConfigModule() {
            const configResult = document.getElementById('config-result');
            const resultDiv = document.getElementById('config-test');
            
            try {
                const { getFirebaseConfig, ASSIGNEES, ERROR_MESSAGES } = await import('./config.js');
                
                // Config í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
                const config = getFirebaseConfig();
                
                const tests = [
                    { name: 'getFirebaseConfig í•¨ìˆ˜', result: typeof getFirebaseConfig === 'function' },
                    { name: 'ASSIGNEES ê°ì²´', result: typeof ASSIGNEES === 'object' && Object.keys(ASSIGNEES).length > 0 },
                    { name: 'ERROR_MESSAGES ê°ì²´', result: typeof ERROR_MESSAGES === 'object' },
                    { name: 'Firebase config ë°˜í™˜', result: config && config.apiKey && config.projectId },
                    { name: 'API Key ìœ íš¨ì„±', result: config.apiKey.startsWith('AIza') }
                ];
                
                const allPassed = tests.every(test => test.result);
                
                if (allPassed) {
                    resultDiv.className = 'result success';
                    configResult.innerHTML = `
                        <p><strong>âœ… Config.js ëª¨ë“ˆì´ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!</strong></p>
                        <pre>${tests.map(t => `âœ… ${t.name}: ${t.result ? 'PASS' : 'FAIL'}`).join('\n')}</pre>
                        <p><strong>Firebase Config:</strong></p>
                        <pre>${JSON.stringify({...config, apiKey: config.apiKey.substring(0, 10) + '...'}, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.className = 'result error';
                    configResult.innerHTML = `
                        <p><strong>âŒ Config.js ëª¨ë“ˆ ë¡œë“œ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</strong></p>
                        <pre>${tests.map(t => `${t.result ? 'âœ…' : 'âŒ'} ${t.name}: ${t.result ? 'PASS' : 'FAIL'}`).join('\n')}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                configResult.innerHTML = `<p><strong>âŒ Config.js ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨:</strong></p><pre>${error.message}</pre>`;
            }
        }
        
        // 3. Firebase ì„¤ì • ìœ íš¨ì„± í…ŒìŠ¤íŠ¸
        async function testFirebaseConfig() {
            const firebaseResult = document.getElementById('firebase-result');
            const resultDiv = document.getElementById('firebase-test');
            
            try {
                const { getFirebaseConfig } = await import('./config.js');
                const config = getFirebaseConfig();
                
                const validations = [
                    { name: 'API Key í˜•ì‹', test: () => config.apiKey && config.apiKey.length > 30 },
                    { name: 'Project ID', test: () => config.projectId === 'ggp-camera' },
                    { name: 'Auth Domain', test: () => config.authDomain && config.authDomain.includes('firebaseapp.com') },
                    { name: 'Storage Bucket', test: () => config.storageBucket && config.storageBucket.includes('appspot.com') },
                    { name: 'Messaging Sender ID', test: () => config.messagingSenderId && config.messagingSenderId.length > 5 },
                    { name: 'App ID', test: () => config.appId && config.appId.includes(':') }
                ];
                
                const results = validations.map(v => {
                    try {
                        const passed = v.test();
                        return { name: v.name, passed, error: null };
                    } catch (error) {
                        return { name: v.name, passed: false, error: error.message };
                    }
                });
                
                const allPassed = results.every(r => r.passed);
                
                if (allPassed) {
                    resultDiv.className = 'result success';
                    firebaseResult.innerHTML = `
                        <p><strong>âœ… Firebase ì„¤ì •ì´ ëª¨ë‘ ìœ íš¨í•©ë‹ˆë‹¤!</strong></p>
                        <pre>${results.map(r => `âœ… ${r.name}: PASS`).join('\n')}</pre>
                        <p><em>ì´ì œ ì‹¤ì œ Firebase ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</em></p>
                    `;
                } else {
                    resultDiv.className = 'result error';
                    firebaseResult.innerHTML = `
                        <p><strong>âŒ Firebase ì„¤ì •ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.</strong></p>
                        <pre>${results.map(r => `${r.passed ? 'âœ…' : 'âŒ'} ${r.name}: ${r.passed ? 'PASS' : 'FAIL'}${r.error ? ' (' + r.error + ')' : ''}`).join('\n')}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                firebaseResult.innerHTML = `<p><strong>âŒ Firebase ì„¤ì • í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:</strong></p><pre>${error.message}</pre>`;
            }
        }
        
        // ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.runAllTests = async function() {
            console.log('ğŸ§ª Firebase í™˜ê²½ë³€ìˆ˜ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            testEnvironmentVariables();
            await testConfigModule();
            await testFirebaseConfig();
            
            console.log('âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ ì™„ë£Œ!');
        };
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', runAllTests);
    </script>
</body>
</html>