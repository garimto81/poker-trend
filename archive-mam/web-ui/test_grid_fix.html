<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·¸ë¦¬ë“œ í¬ê¸° ìˆ˜ì • í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .video-container {
            position: relative;
            display: inline-block;
            width: 100%;
            margin: 20px 0;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
        }
        video {
            width: 100%;
            height: auto;
            display: block;
        }
        .grid-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        .status {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #4CAF50;
            background: #2a2a2a;
        }
        .error {
            border-left-color: #f44336;
        }
        .warning {
            border-left-color: #ff9800;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ ê·¸ë¦¬ë“œ í¬ê¸° ìˆ˜ì • í…ŒìŠ¤íŠ¸</h1>
        
        <div class="status">
            <h3>í…ŒìŠ¤íŠ¸ ìƒíƒœ</h3>
            <div id="testStatus">í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...</div>
        </div>
        
        <input type="file" id="videoFile" accept="video/*" style="margin: 10px 0;">
        
        <div class="video-container">
            <video id="testVideo" controls>
                <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
            </video>
            <canvas class="grid-overlay" id="testGridOverlay"></canvas>
        </div>
        
        <div>
            <button onclick="testGridSize()">ê·¸ë¦¬ë“œ í¬ê¸° í…ŒìŠ¤íŠ¸</button>
            <button onclick="toggleGrid()">ê·¸ë¦¬ë“œ í‘œì‹œ/ìˆ¨ê¸°ê¸°</button>
            <button onclick="resizeTest()">í¬ê¸° ì¡°ì • í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <div id="testResults"></div>
    </div>
    
    <script>
        let video = null;
        let gridOverlay = null;
        let gridCtx = null;
        let showGrid = false;
        
        document.addEventListener('DOMContentLoaded', () => {
            video = document.getElementById('testVideo');
            gridOverlay = document.getElementById('testGridOverlay');
            gridCtx = gridOverlay.getContext('2d');
            
            // ë¹„ë””ì˜¤ ë¡œë“œ ì™„ë£Œ ì‹œ
            video.addEventListener('loadedmetadata', () => {
                addTestResult('âœ… ë¹„ë””ì˜¤ ë¡œë“œ ì™„ë£Œ', 'success');
                resizeGridOverlay();
            });
            
            // íŒŒì¼ ì„ íƒ
            document.getElementById('videoFile').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    video.src = URL.createObjectURL(file);
                    addTestResult('ğŸ“ ìƒˆ ë¹„ë””ì˜¤ íŒŒì¼ ë¡œë“œ', 'info');
                }
            });
            
            // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ
            window.addEventListener('resize', () => {
                resizeGridOverlay();
                addTestResult('ğŸ”„ ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ê°ì§€', 'info');
            });
            
            updateStatus('í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ');
        });
        
        function resizeGridOverlay() {
            if (!video || !gridOverlay) return;
            
            // ë¹„ë””ì˜¤ì˜ ì‹¤ì œ í‘œì‹œ í¬ê¸° ê°€ì ¸ì˜¤ê¸°
            const rect = video.getBoundingClientRect();
            
            // ì´ì „ í¬ê¸° ì €ì¥
            const oldWidth = gridOverlay.width;
            const oldHeight = gridOverlay.height;
            
            // ìƒˆ í¬ê¸° ì„¤ì •
            gridOverlay.width = rect.width;
            gridOverlay.height = rect.height;
            
            addTestResult(
                `ğŸ“ ê·¸ë¦¬ë“œ í¬ê¸° ì¡°ì •: ${oldWidth}x${oldHeight} â†’ ${gridOverlay.width}x${gridOverlay.height}`,
                oldWidth !== gridOverlay.width || oldHeight !== gridOverlay.height ? 'warning' : 'info'
            );
            
            // ê·¸ë¦¬ë“œ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
            if (showGrid) {
                drawGrid();
            }
        }
        
        function drawGrid() {
            if (!gridCtx || !gridOverlay) return;
            
            gridCtx.clearRect(0, 0, gridOverlay.width, gridOverlay.height);
            
            const cellWidth = gridOverlay.width / 3;
            const cellHeight = gridOverlay.height / 3;
            
            for (let row = 0; row < 3; row++) {
                for (let col = 0; col < 3; col++) {
                    const x = col * cellWidth;
                    const y = row * cellHeight;
                    
                    // ê²½ê³„ì„ 
                    gridCtx.strokeStyle = '#4CAF50';
                    gridCtx.lineWidth = 2;
                    gridCtx.strokeRect(x, y, cellWidth, cellHeight);
                    
                    // ì˜ì—­ ë²ˆí˜¸
                    gridCtx.fillStyle = 'white';
                    gridCtx.font = '20px Arial';
                    gridCtx.textAlign = 'center';
                    gridCtx.textBaseline = 'middle';
                    gridCtx.fillText(
                        `${row * 3 + col + 1}`,
                        x + cellWidth / 2,
                        y + cellHeight / 2
                    );
                }
            }
        }
        
        function testGridSize() {
            updateStatus('ê·¸ë¦¬ë“œ í¬ê¸° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            // ë¹„ë””ì˜¤ í¬ê¸° í™•ì¸
            const videoRect = video.getBoundingClientRect();
            const videoInfo = `ë¹„ë””ì˜¤ í¬ê¸°: ${videoRect.width.toFixed(1)} x ${videoRect.height.toFixed(1)}`;
            
            // ê·¸ë¦¬ë“œ í¬ê¸° í™•ì¸
            const gridInfo = `ê·¸ë¦¬ë“œ í¬ê¸°: ${gridOverlay.width} x ${gridOverlay.height}`;
            
            // ì¼ì¹˜ ì—¬ë¶€ í™•ì¸
            const isMatching = Math.abs(videoRect.width - gridOverlay.width) < 1 && 
                              Math.abs(videoRect.height - gridOverlay.height) < 1;
            
            addTestResult(videoInfo, 'info');
            addTestResult(gridInfo, 'info');
            addTestResult(
                isMatching ? 'âœ… í¬ê¸°ê°€ ì •í™•íˆ ì¼ì¹˜í•©ë‹ˆë‹¤!' : 'âŒ í¬ê¸°ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!',
                isMatching ? 'success' : 'error'
            );
            
            updateStatus('í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
            
            // ê·¸ë¦¬ë“œ í‘œì‹œ
            showGrid = true;
            drawGrid();
        }
        
        function toggleGrid() {
            showGrid = !showGrid;
            if (showGrid) {
                drawGrid();
                addTestResult('ğŸ¯ ê·¸ë¦¬ë“œ í‘œì‹œ', 'info');
            } else {
                gridCtx.clearRect(0, 0, gridOverlay.width, gridOverlay.height);
                addTestResult('ğŸš« ê·¸ë¦¬ë“œ ìˆ¨ê¹€', 'info');
            }
        }
        
        function resizeTest() {
            updateStatus('í¬ê¸° ì¡°ì • í…ŒìŠ¤íŠ¸...');
            
            // ë¹„ë””ì˜¤ ì»¨í…Œì´ë„ˆ í¬ê¸° ë³€ê²½
            const container = document.querySelector('.video-container');
            const currentWidth = container.style.width || '100%';
            
            if (currentWidth === '100%') {
                container.style.width = '600px';
                addTestResult('ğŸ“ ì»¨í…Œì´ë„ˆ í¬ê¸°: 600pxë¡œ ë³€ê²½', 'warning');
            } else {
                container.style.width = '100%';
                addTestResult('ğŸ“ ì»¨í…Œì´ë„ˆ í¬ê¸°: 100%ë¡œ ë³€ê²½', 'warning');
            }
            
            // ì ì‹œ í›„ ê·¸ë¦¬ë“œ í¬ê¸° ì¡°ì •
            setTimeout(() => {
                resizeGridOverlay();
                updateStatus('í¬ê¸° ì¡°ì • ì™„ë£Œ');
            }, 100);
        }
        
        function updateStatus(message) {
            document.getElementById('testStatus').textContent = message;
        }
        
        function addTestResult(message, type = 'info') {
            const results = document.getElementById('testResults');
            const result = document.createElement('div');
            result.className = 'test-result';
            
            if (type === 'error') result.classList.add('error');
            if (type === 'warning') result.classList.add('warning');
            
            const time = new Date().toLocaleTimeString();
            result.innerHTML = `<strong>[${time}]</strong> ${message}`;
            
            results.insertBefore(result, results.firstChild);
            
            // ìµœëŒ€ 10ê°œë§Œ ìœ ì§€
            while (results.children.length > 10) {
                results.removeChild(results.lastChild);
            }
        }
    </script>
</body>
</html>