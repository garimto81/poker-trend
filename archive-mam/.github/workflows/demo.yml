name: Deploy Demo

on:
  push:
    branches: [ master, main ]
  workflow_dispatch:

jobs:
  deploy-demo:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    - name: Create demo page
      run: |
        mkdir -p demo
        cat > demo/index.html << 'EOF'
        <!DOCTYPE html>
        <html lang="ko">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Poker MAM - 온라인 데모</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
            <style>
                .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
                .feature-card { transition: transform 0.3s; }
                .feature-card:hover { transform: translateY(-5px); }
            </style>
        </head>
        <body>
            <div class="hero text-white py-5">
                <div class="container text-center">
                    <h1 class="display-4">🃏 Poker MAM</h1>
                    <p class="lead">AI 기반 포커 영상 분석 시스템</p>
                    <div class="mt-4">
                        <a href="https://github.com/your-username/Archive-MAM" class="btn btn-light btn-lg me-2">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                        <a href="#demo" class="btn btn-warning btn-lg">
                            <i class="fas fa-play"></i> 데모 시작
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="container my-5">
                <h2 class="text-center mb-5">✨ 주요 기능</h2>
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="card feature-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-bolt fa-3x text-warning mb-3"></i>
                                <h4>고속 분석</h4>
                                <p>10분 영상을 1-2분 내에 분석</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card feature-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-brain fa-3x text-primary mb-3"></i>
                                <h4>AI 핸드 감지</h4>
                                <p>자동으로 핸드 시작/종료 감지</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card feature-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-chart-bar fa-3x text-success mb-3"></i>
                                <h4>통계 분석</h4>
                                <p>핸드 길이별 분류 및 시각화</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="container my-5" id="demo">
                <h2 class="text-center mb-5">🎮 온라인 데모</h2>
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">테스트 방법</h5>
                                <ol>
                                    <li>GitHub Codespaces에서 실행</li>
                                    <li>샘플 비디오로 테스트</li>
                                    <li>고속 모드 ON/OFF 비교</li>
                                </ol>
                                <div class="d-grid gap-2 mt-4">
                                    <a href="https://github.com/codespaces/new?template=your-username/Archive-MAM" 
                                       class="btn btn-primary btn-lg">
                                        <i class="fas fa-rocket"></i> Codespaces에서 실행
                                    </a>
                                    <a href="https://gitpod.io/#https://github.com/your-username/Archive-MAM" 
                                       class="btn btn-secondary btn-lg">
                                        <i class="fas fa-code"></i> Gitpod에서 실행
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-info mt-4">
                            <h6>💡 빠른 테스트 명령어</h6>
                            <pre class="mb-0"><code># 환경 설정
python setup_test_env.py

# 웹 서버 실행
python run_poker_app.py

# 접속: http://localhost:5000</code></pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="container my-5">
                <h2 class="text-center mb-5">📊 성능 비교</h2>
                <canvas id="performanceChart" height="100"></canvas>
            </div>
            
            <script src="https://kit.fontawesome.com/your-key.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script>
                // 성능 차트
                const ctx = document.getElementById('performanceChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['기존 방식', '고속 모드 (15:1)', '고속 모드 (30:1)', '고속 모드 (60:1)'],
                        datasets: [{
                            label: '분석 시간 (분)',
                            data: [600, 5, 3, 1.5],
                            backgroundColor: ['#dc3545', '#ffc107', '#28a745', '#007bff']
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '시간 (분)'
                                }
                            }
                        }
                    }
                });
            </script>
        </body>
        </html>
        EOF
    
    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./demo