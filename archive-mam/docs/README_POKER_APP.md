# 🃏 포커 대회 영상 분석 웹 애플리케이션

YouTube 링크나 비디오 파일을 입력받아 포커 핸드의 길이를 자동으로 분석하는 AI 기반 웹 애플리케이션입니다.

## 🌟 주요 기능

### 📹 비디오 입력 방식
- **스트리밍 URL**: YouTube, Twitch, 직접 비디오 링크 등을 바로 스트리밍 분석 (다운로드 없음)
- **파일 업로드**: 로컬 비디오 파일 업로드 (MP4, AVI, MOV, MKV, FLV, WEBM)

### 🤖 AI 기반 분석
- **핸드 경계 감지**: 90%+ 정확도로 포커 핸드 시작/종료 지점 감지
- **모션 분석**: 딜링, 팟 수집 모션 패턴 인식
- **객체 감지**: 카드, 칩 감지 및 추적

### 📊 핸드 길이 분류
- **매우 짧은 핸드**: 0-45초 (빠른 폴드)
- **짧은 핸드**: 45-90초 (일반적인 핸드)
- **보통 핸드**: 90-180초 (평균적인 플레이)
- **긴 핸드**: 180-300초 (깊은 생각)
- **매우 긴 핸드**: 300초+ (올인 상황 등)

### 📈 시각화 및 통계
- **분포 차트**: 핸드 길이별 원형 차트
- **타임라인**: 시간대별 핸드 수 막대 차트
- **상세 통계**: 평균, 최장/최단 핸드, 신뢰도 등
- **핸드 목록**: 전체 핸드 상세 정보 테이블

## 🚀 설치 및 실행

### 1. 시스템 요구사항
- **Python**: 3.8 이상
- **메모리**: 4GB 이상 권장
- **디스크**: 5GB 이상 여유 공간
- **OS**: Windows, macOS, Linux

### 2. 종속성 설치
```bash
# 자동 설치
python run_poker_app.py install

# 또는 수동 설치
pip install -r requirements.txt
```

### 3. 실행 방법

#### 개발 모드 (개발/테스트용)
```bash
python run_poker_app.py dev
```

#### 프로덕션 모드 (실제 서비스용)
```bash
# 기본 실행
python run_poker_app.py prod

# 포트 및 워커 수 설정
python run_poker_app.py prod --port 8000 --workers 6
```

#### 시스템 체크
```bash
python run_poker_app.py check
```

### 4. 웹 브라우저 접속
```
http://localhost:5000
```

## 📖 사용법

### 1. 영상 입력
- **비디오 URL 탭**: YouTube, Twitch, 직접 비디오 링크 등 입력 (스트리밍 분석)
- **파일 업로드 탭**: 로컬 비디오 파일 선택

### 2. 분석 옵션 설정
- **분석 정밀도**: 일반/높음/매우 높음
- **분류 방식**: 표준(5단계)/상세(10단계)

### 3. 분석 시작
- "분석 시작" 버튼 클릭
- 실시간 진행 상황 모니터링

### 4. 결과 확인
- **요약 통계**: 총 핸드 수, 평균 길이, 총 게임 시간
- **분포 차트**: 핸드 길이별 시각화
- **상세 정보**: 개별 핸드 정보 및 신뢰도

### 5. 결과 활용
- **JSON 다운로드**: 분석 결과 데이터 저장
- **결과 공유**: 링크 복사 및 공유
- **새 분석**: 추가 영상 분석

## 🎯 분석 정확도

### 감지 알고리즘
- **시작 감지**: 75점 이상 신뢰도 (새 카드 출현 + 딜링 모션)
- **종료 감지**: 80점 이상 신뢰도 (팟 수집 + 칩 분포 변화)
- **검증 시스템**: 시간적 일관성 및 오탐 방지

### 지원 영상 유형
- **테이블 뷰**: 위에서 내려다보는 포커 테이블
- **TV 중계**: 일반적인 포커 대회 중계 영상
- **라이브 스트리밍**: 온라인 포커 플랫폼 녹화

## ⚙️ 고급 설정

### 환경 변수
```bash
# 임시 파일 디렉토리
TEMP_VIDEO_DIR=temp_videos

# 결과 저장 디렉토리  
RESULTS_DIR=analysis_results

# 최대 업로드 크기 (MB)
MAX_UPLOAD_SIZE=2048

# 분석 타임아웃 (초)
ANALYSIS_TIMEOUT=3600
```

### 성능 튜닝
```python
# poker_analyzer_app.py에서 수정 가능한 설정
DETECTOR_CONFIG = {
    'start_threshold': 75,    # 핸드 시작 감지 임계값
    'end_threshold': 80,      # 핸드 종료 감지 임계값
    'min_hand_duration': 30,  # 최소 핸드 길이 (초)
    'max_hand_duration': 600  # 최대 핸드 길이 (초)
}
```

## 🛠️ 개발자 정보

### 프로젝트 구조
```
Archive-MAM/
├── poker_analyzer_app.py          # 메인 Flask 애플리케이션
├── run_poker_app.py              # 실행 스크립트
├── src/
│   ├── hand_boundary_detector.py # 핸드 감지 엔진
│   └── hand_detection_visualizer.py # 시각화 도구
├── templates/                    # HTML 템플릿
│   ├── base.html
│   ├── index.html
│   └── results.html
├── temp_videos/                  # 임시 비디오 저장
├── analysis_results/             # 분석 결과 저장
└── static/                       # 정적 파일
```

### API 엔드포인트
- `POST /analyze`: 분석 시작
- `GET /progress/<task_id>`: 진행 상황 조회
- `GET /results/<task_id>`: 결과 페이지
- `GET /api/results/<task_id>`: 결과 JSON
- `GET /download/<task_id>`: 결과 파일 다운로드

### 커스터마이징
1. **핸드 분류 기준 변경**: `HandLengthClassifier` 클래스 수정
2. **UI 테마 변경**: `templates/base.html` CSS 수정
3. **감지 알고리즘 튜닝**: `HandBoundaryDetector` 파라미터 조정

## 🔧 문제 해결

### 일반적인 문제
1. **종속성 오류**: `python run_poker_app.py install`
2. **메모리 부족**: 비디오 해상도 낮추기 (720p 이하)
3. **YouTube 다운로드 실패**: yt-dlp 업데이트
4. **분석 속도 느림**: 정밀도 설정을 '일반'으로 변경

### 로그 확인
```bash
# 개발 모드에서 자세한 로그 확인
python run_poker_app.py dev
```

### 성능 최적화
- **GPU 사용**: OpenCV GPU 빌드 설치
- **멀티프로세싱**: 워커 수 증가
- **캐싱**: 결과 캐시 활용

## 📞 지원

### 버그 리포트
- 이슈 발생 시 로그와 함께 상세한 설명 제공
- 테스트 비디오 파일 또는 YouTube 링크 포함

### 기능 요청
- 새로운 분석 기능 아이디어
- UI/UX 개선 제안
- 성능 최적화 아이디어

---

## 📝 업데이트 로그

### v1.1.0 (2024-01-30)
- **스트리밍 분석**: 다운로드 없이 URL에서 직접 비디오 스트리밍 분석
- **다중 플랫폼 지원**: YouTube, Twitch, 직접 비디오 링크 등
- **성능 최적화**: 메모리 사용량 감소 및 처리 속도 향상
- **개선된 진행률 추적**: 실시간 스트리밍 진행 상황 표시

### v1.0.0 (2024-01-30)
- 초기 릴리스
- YouTube URL 및 파일 업로드 지원
- 5단계 핸드 길이 분류
- 실시간 진행 상황 표시
- 웹 기반 시각화 대시보드

---

**🃏 포커 분석을 통해 더 나은 게임 이해를 얻으세요!**